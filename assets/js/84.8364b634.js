(window.webpackJsonp=window.webpackJsonp||[]).push([[84],{574:function(s,t,a){"use strict";a.r(t);var n=a(4),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"包和工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#包和工具"}},[s._v("#")]),s._v(" 包和工具")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("Go 语言的闪电般的编译速度主要得益于三个语言特性：")]),s._v(" "),a("ol",[a("li",[s._v("所有导入的包必须在每个文件的开头显式声明，这样的话编译器就没有必要读取和分析整个源文件来判断包的依赖关系。")]),s._v(" "),a("li",[s._v("禁止包的环状依赖，因为没有循环依赖，包的依赖关系形成一个"),a("strong",[s._v("有向无环图")]),s._v("，每个包可以被"),a("strong",[s._v("独立编译")]),s._v("，而且很可能是被"),a("strong",[s._v("并发编译")]),s._v("。")]),s._v(" "),a("li",[s._v("编译后包的目标文件不仅仅记录包本身的导出信息，"),a("strong",[s._v("目标文件同时还记录了包的依赖关系")]),s._v("。")])]),s._v(" "),a("p",[s._v("因此，在编译一个包的时候，编译器只需要读取每个直接导入包的目标文件，而不需要遍历所有依赖的文件。（很多都是重复的间接依赖）")])]),s._v(" "),a("li",[a("p",[s._v("导入路径：import 中的字符串，第三方包的导入路径建议以所在组织的互联网域名为前缀")])]),s._v(" "),a("li",[a("p",[s._v("包声明：package 包名，包声明语句的主要目的是确定当前包被其它包导入时默认的标识符（也称为包名）。")]),s._v(" "),a("p",[s._v("通常来说，"),a("strong",[s._v("默认的包名就是包导入路径名的最后一段")]),s._v("，因此即使两个包的导入路径不同，它们依然可能有一个相同的包名（math/rand 和 crypto/rand）。")]),s._v(" "),a("p",[s._v("例外情况：")]),s._v(" "),a("ol",[a("li",[s._v("main 包（可执行程序），其导入路径是无关紧要的，名字为 main 的包是给 go build 构建命令一个信息，这个包编译完之后必须调用连接器生成一个可执行程序。")]),s._v(" "),a("li",[s._v("包目录中以 "),a("code",[s._v("_test.go")]),s._v(" 为后缀的 Go 源文件（前面必须有其他字符，因为以 "),a("code",[s._v("_")]),s._v(" 或 "),a("code",[s._v(".")]),s._v(" 开头的源文件会被构建工具忽略），并且这些源文件的包名也是以 "),a("code",[s._v("_test")]),s._v(" 为后缀包名的测试外部扩展包都由 go test 命令独立编译，普通包和测试的外部扩展包是相互独立的。测试的外部扩展包一般用来避免测试代码中的循环导入依赖。")]),s._v(" "),a("li",[s._v("一些依赖版本号的管理工具会在导入路径后追加版本号信息，例如 "),a("code",[s._v("gopkg.in/yaml.v2")]),s._v(" 这种情况下包的名字并不包含版本号后缀，而是 "),a("code",[s._v("yaml")])])])]),s._v(" "),a("li",[a("p",[s._v("导入声明：在包声明语句之后，其他非导入声明语句之前，可以有零到多个导入声明语句，每个导入声明可以单独指定一个导入路径，但一般把所有导入声明放在一个 import 后。")]),s._v(" "),a("p",[s._v("导入的包之间可以添加空行来进行分组；通常将来自不同组织的包分组，包的导入顺序无关紧要。")]),s._v(" "),a("p",[s._v("如果要导入两个名字相同的包，需要至少为其中一个指定别名（包的重命名）")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"crypto/rand"')]),s._v("\n  mrand "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"math/rand"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("导入包的重命名只影响当前的源文件。其它的源文件如果导入了相同的包，可以用导入包原本默认的名字或重命名为另一个完全不同的名字。")]),s._v(" "),a("p",[s._v("导入包重命名是一个有用的特性，它不仅仅只是为了解决名字冲突。如果导入的一个包名很笨重，特别是在一些自动生成的代码中，这时候用一个简短名称会更方便。选择用简短名称重命名导入包时候最好统一（在不同的源文件中），以避免包名混乱。选择另一个包名称还可以帮助避免和本地普通变量名产生冲突。例如，如果文件中已经有了一个名为 path 的变量，那么我们可以将 “path” 标准包重命名为 pathpkg。")])]),s._v(" "),a("li",[a("p",[s._v("包的匿名导入：只导入一个包但不使用会导致编译错误，但有时候只是需要这个包变量的初始化表达式和执行导入包的 init 初始化函数，此时可以通过 "),a("code",[s._v("_")]),s._v(" 来重命名导入的包")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("_")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"image/png"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("这是包的匿名导入，通常是用来实现一个编译时机制，然后通过在 main 主程序入口选择性地导入附加的包。在图片格式转换示例中：")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fmt"')]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"image"')]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"image/jpeg"')]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("_")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"image/png"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 注册 png decoder")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"io"')]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"os"')]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("toJPEG")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("in io"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Reader"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" out io"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Writer"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("error")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\timg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" kind"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" err "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" image"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Decode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("in"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" err "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("nil")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" err\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\tfmt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Fprintln")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("os"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Stderr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Input format ="')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" kind"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("return")]),s._v(" jpeg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Encode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("out"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" img"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("jpeg"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("Quality"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("95")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" err "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("toJPEG")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("os"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Stdin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" os"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Stdout"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" err "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("nil")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n\t\tfmt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Fprintf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("os"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Stderr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"jpeg: %v\\n"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t\tos"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Exit")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br")])]),a("p",[s._v("如果不匿名导入 "),a("code",[s._v("image/png")]),s._v(" 包，"),a("code",[s._v("image.Decode")]),s._v(" 就会出现错误，识别不了 png 格式。因为在 "),a("code",[s._v("image/png")]),s._v(" 包中，向 "),a("code",[s._v("image.Decode")]),s._v(" 注册了 png 格式（格式名称、一个用于描述这种图像数据开头部分模式的字符串，用于解码器检测识别、一个 Decode 函数用于完成解码工作；一个 DecodeConfig 函数用于解码图像的大小和颜色空间的信息）每个驱动入口是通过调用 "),a("code",[s._v("image.RegisterFormat")]),s._v(" 函数进行注册（一般位于包的 init 函数中）")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" png "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// image/png")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Decode")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("r io"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Reader"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("image"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Image"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("DecodeConfig")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("r io"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Reader"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("image"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("Config"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token builtin"}},[s._v("error")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("init")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("const")]),s._v(" pngHeader "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"\\x89PNG\\r\\n\\x1a\\n"')]),s._v("\n    image"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("RegisterFormat")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"png"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" pngHeader"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Decode"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" DecodeConfig"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("p",[s._v("所以只要匿名导入 "),a("code",[s._v("image/png")]),s._v(" 包就可以用 "),a("code",[s._v("image.Decode")]),s._v(" 解码 png 格式的图像。")]),s._v(" "),a("p",[s._v("其他的还有例如数据库驱动也是采用这样的方式（"),a("code",[s._v("database/sql")]),s._v("）：让用户根据自己的需要导入相应的数据库驱动）")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"database/sql"')]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("_")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"github.com/lib/pq"')]),s._v("              "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// enable support for Postgres")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("_")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"github.com/go-sql-driver/mysql"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// enable support for MySQL")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\ndb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" err "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"postgres"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" dbname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// OK")]),s._v("\ndb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" err "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mysql"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" dbname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// OK")]),s._v("\ndb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" err "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" sql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Open")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"sqlite3"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" dbname"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('// returns error: unknown driver "sqlite3"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("包和命名")]),s._v(" "),a("ol",[a("li",[s._v("短小包名")]),s._v(" "),a("li",[s._v("命名有描述性且无歧义")]),s._v(" "),a("li",[s._v("一般采用单数形式")]),s._v(" "),a("li",[s._v("避免包名有其他含义")])]),s._v(" "),a("p",[s._v("命名包的成员：需要考虑包名和成员名的配合")])]),s._v(" "),a("li",[a("p",[s._v("工具：Go 语言的工具箱集合了一系列功能的命令集。它可以看作是一个包管理器（类似于 Linux 中的 apt 和 rpm 工具），用于包的查询、计算包的依赖关系、从远程版本控制系统下载它们等任务。它也是一个单元测试和基准测试的驱动程序。")]),s._v(" "),a("ul",[a("li",[a("p",[a("code",[s._v("GOPATH")]),s._v(" 工作区目录")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("GOROOT")]),s._v(" Go 的安装目录、标准库包的位置")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("go env")]),s._v(" 查看环境变量")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("go get")]),s._v(" 下载包，同时计算并下载所依赖的每个包")]),s._v(" "),a("p",[s._v("导入路径含有的网站域名和本地 Git 仓库对应远程服务地址并不一定相同，包的导入路径地址可以自定义")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("go build")]),s._v(" 编译包，如果包是一个库，则忽略输出（此时包是正确编译的）；如果包名是 main，则在当前目录生成一个可执行程序，以导入路径的最后一段作为可执行程序的名字。")]),s._v(" "),a("p",[s._v("每个包可以由导入路径指定，使用相对路径必须以 "),a("code",[s._v(".")]),s._v(" 或 "),a("code",[s._v("..")]),s._v(" 开头，没有指定参数则默认在当前目录")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[s._v("$ cd $GOPATH"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("src"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("gopl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("ch1"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("helloworld\n$ "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("go")]),s._v(" build "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 当前目录")]),s._v("\n\n$ cd anywhere\n$ "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("go")]),s._v(" build gopl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("ch1"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("helloworld "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 导入路径")]),s._v("\n\n$ cd $GOPATH\n$ "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("go")]),s._v(" build "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("src"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("gopl"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("ch1"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("helloworld "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// 相对路径")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("可以指定源文件列表（不是一个完整的包的情况下），如果是 main 包，以最后一个 Go 源文件的文件名作为可执行程序的名字。")]),s._v(" "),a("p",[s._v("默认情况下，"),a("code",[s._v("go build")]),s._v(" 命令构建指定的包和它依赖的包，然后"),a("strong",[s._v("丢弃")]),s._v("除了最后的可执行文件之外所有的中间编译结果。")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("go run")]),s._v(" 构建 + 运行")])]),s._v(" "),a("li",[a("p",[a("code",[s._v("go install")]),s._v(" 会保存每个包的编译成果，放在 "),a("code",[s._v("$GOPATH/pkg")]),s._v(" 下，可执行程序在 "),a("code",[s._v("$GOPATH/bin")]),s._v(" 下，"),a("code",[s._v("go install")]),s._v(" 和 "),a("code",[s._v("go build")]),s._v(" 命令都不会重新编译没有发生变化的包，"),a("code",[s._v("go build -i")]),s._v(" 命令将安装每个目标所依赖的包")])]),s._v(" "),a("li",[a("p",[s._v("设置好 "),a("code",[s._v("GOOS")]),s._v(" 和 "),a("code",[s._v("GOARCH")]),s._v(" 就可以针对不同的操作系统或 CPU 的交叉构建：")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("func")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  fmt"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("Println")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("runtime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("GOOS"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" runtime"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("GOARCH"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\ndarwin amd64\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("有些包可能需要针对不同平台和处理器类型使用不同版本的代码文件，以便于处理底层的可移植性问题或为一些特定代码提供优化。如果一个文件名包含了一个操作系统或处理器类型名字，例如 net_linux.go 或 asm_amd64.s，Go语言的构建工具将只在对应的平台编译这些文件。")]),s._v(" "),a("p",[s._v("一个特别的构建注释参数可以提供更多的构建过程控制")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// +build linux darwin 只在 Linux MacOSX 下编译")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("// +build igonre 不编译")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])])]),s._v(" "),a("li",[a("p",[a("code",[s._v("go doc")]),s._v(" 打印其后所制定的实体的声明与文档注释，实体可能是一个包、包成员、包方法。")]),s._v(" "),a("p",[s._v("如果注释后紧跟着包声明语句，那注释对应整个包的文档。")]),s._v(" "),a("p",[s._v("该命令不需要输入完整的包导入路径或正确的大小写")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("go doc json.decode // "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("*json.Decoder"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(".Decode "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" encoding/json\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[a("code",[s._v("godoc")]),s._v(" HTML 页面文档")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[s._v("godoc "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("http"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("li",[a("p",[s._v("内部包：Go 语言的构建工具对"),a("strong",[s._v("包含 internal 名字的路径段的包导入路径")]),s._v("做了特殊处理，只能被和该包有同一个父目录的包所导入。例如 "),a("code",[s._v("net/http/internal/chunked")]),s._v(" 内部包只能被 "),a("code",[s._v("net/http/httputil")]),s._v(" 或 "),a("code",[s._v("net/http")]),s._v(" 包导入，但是不能被 "),a("code",[s._v("net/url")]),s._v(" 包导入；但是 "),a("code",[s._v("net/url")]),s._v(" 包可以导入 "),a("code",[s._v("net/http/httputil")]),s._v(" 包（无 internal）")]),s._v(" "),a("div",{staticClass:"language-go line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-go"}},[a("code",[s._v("net"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("http\nnet"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("http"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("internal"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("chunked\nnet"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("http"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("httputil\nnet"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("url\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])])]),s._v(" "),a("li",[a("p",[a("code",[s._v("go list")]),s._v(" 查询可用包的信息，可以测试包是否在工作区并打印它的导入路径")]),s._v(" "),a("p",[a("code",[s._v("go list ...")]),s._v(" 列出工作区中的所有包")]),s._v(" "),a("p",[a("code",[s._v("go list gopl.io/ch3/...")]),s._v(" 列出特定子目录下的所有包")]),s._v(" "),a("p",[a("code",[s._v("go list ...xml...")]),s._v(" 和某个主题相关的所有包")]),s._v(" "),a("p",[a("code",[s._v("go list -json")]),s._v(" 获取包完整的元信息")]),s._v(" "),a("p",[a("code",[s._v("go list -f")]),s._v(" 允许使用 text/template 包的模版语言定义输出文本的格式")])])])])])])}),[],!1,null,null,null);t.default=e.exports}}]);
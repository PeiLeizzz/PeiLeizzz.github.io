<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ã€ŠGo è¯­è¨€åœ£ç»ã€‹æµ‹è¯• | LazySwifts</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="/sun.png">
    <script>var _hmt = _hmt || [];
      (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?bfb42b068181dcaabb4335db407b2a6f";
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
      })();</script>
    <meta name="description" content="Take excellence as a habit">
    <link rel="preload" href="/assets/css/0.styles.a94fce00.css" as="style"><link rel="preload" href="/assets/js/app.80d57d75.js" as="script"><link rel="preload" href="/assets/js/3.187167f1.js" as="script"><link rel="preload" href="/assets/js/1.965fe851.js" as="script"><link rel="preload" href="/assets/js/85.b19281d5.js" as="script"><link rel="prefetch" href="/assets/js/10.8d4c2312.js"><link rel="prefetch" href="/assets/js/100.0a18407d.js"><link rel="prefetch" href="/assets/js/101.19f6f4ae.js"><link rel="prefetch" href="/assets/js/102.c54cf054.js"><link rel="prefetch" href="/assets/js/103.69fb1121.js"><link rel="prefetch" href="/assets/js/104.611687e5.js"><link rel="prefetch" href="/assets/js/105.8c2687ef.js"><link rel="prefetch" href="/assets/js/106.80a01d9a.js"><link rel="prefetch" href="/assets/js/107.dd5a49ff.js"><link rel="prefetch" href="/assets/js/108.08705abd.js"><link rel="prefetch" href="/assets/js/11.e977e67e.js"><link rel="prefetch" href="/assets/js/12.768cb1dd.js"><link rel="prefetch" href="/assets/js/13.7d2faadb.js"><link rel="prefetch" href="/assets/js/14.ad6f91db.js"><link rel="prefetch" href="/assets/js/15.1d6e4aba.js"><link rel="prefetch" href="/assets/js/16.61e9d2b8.js"><link rel="prefetch" href="/assets/js/17.eff00b6e.js"><link rel="prefetch" href="/assets/js/18.1c434eee.js"><link rel="prefetch" href="/assets/js/19.9a42c247.js"><link rel="prefetch" href="/assets/js/20.608a8cef.js"><link rel="prefetch" href="/assets/js/21.73078f6d.js"><link rel="prefetch" href="/assets/js/22.3eb47e28.js"><link rel="prefetch" href="/assets/js/23.aa340a84.js"><link rel="prefetch" href="/assets/js/24.cc96dcab.js"><link rel="prefetch" href="/assets/js/25.ed9ccb6f.js"><link rel="prefetch" href="/assets/js/26.8f578880.js"><link rel="prefetch" href="/assets/js/27.a8973f37.js"><link rel="prefetch" href="/assets/js/28.4e94e363.js"><link rel="prefetch" href="/assets/js/29.38b7d140.js"><link rel="prefetch" href="/assets/js/30.d502c466.js"><link rel="prefetch" href="/assets/js/31.9ff5696c.js"><link rel="prefetch" href="/assets/js/32.dd094132.js"><link rel="prefetch" href="/assets/js/33.bb3526f0.js"><link rel="prefetch" href="/assets/js/34.0057fe6f.js"><link rel="prefetch" href="/assets/js/35.d20eed5b.js"><link rel="prefetch" href="/assets/js/36.dbf204b9.js"><link rel="prefetch" href="/assets/js/37.7c722428.js"><link rel="prefetch" href="/assets/js/38.e3cb4d47.js"><link rel="prefetch" href="/assets/js/39.9a9ca98e.js"><link rel="prefetch" href="/assets/js/4.12ddd8f1.js"><link rel="prefetch" href="/assets/js/40.af513c27.js"><link rel="prefetch" href="/assets/js/41.e27e05b9.js"><link rel="prefetch" href="/assets/js/42.db46fcd9.js"><link rel="prefetch" href="/assets/js/43.c52c461f.js"><link rel="prefetch" href="/assets/js/44.5172bb3f.js"><link rel="prefetch" href="/assets/js/45.51a56239.js"><link rel="prefetch" href="/assets/js/46.16b9c080.js"><link rel="prefetch" href="/assets/js/47.02ed6b2a.js"><link rel="prefetch" href="/assets/js/48.e963edec.js"><link rel="prefetch" href="/assets/js/49.418e2579.js"><link rel="prefetch" href="/assets/js/5.95952000.js"><link rel="prefetch" href="/assets/js/50.a21016c3.js"><link rel="prefetch" href="/assets/js/51.f9afb253.js"><link rel="prefetch" href="/assets/js/52.1b190232.js"><link rel="prefetch" href="/assets/js/53.df7d7fbe.js"><link rel="prefetch" href="/assets/js/54.4dbc9d3b.js"><link rel="prefetch" href="/assets/js/55.c52f1a6a.js"><link rel="prefetch" href="/assets/js/56.1ab37a88.js"><link rel="prefetch" href="/assets/js/57.e6ebb094.js"><link rel="prefetch" href="/assets/js/58.684481a7.js"><link rel="prefetch" href="/assets/js/59.d614f15a.js"><link rel="prefetch" href="/assets/js/6.d5aaee5e.js"><link rel="prefetch" href="/assets/js/60.34a45e4e.js"><link rel="prefetch" href="/assets/js/61.369433e8.js"><link rel="prefetch" href="/assets/js/62.b16c43d6.js"><link rel="prefetch" href="/assets/js/63.8e4ada6e.js"><link rel="prefetch" href="/assets/js/64.4caf02ad.js"><link rel="prefetch" href="/assets/js/65.0fe27510.js"><link rel="prefetch" href="/assets/js/66.03c91498.js"><link rel="prefetch" href="/assets/js/67.b0f1209b.js"><link rel="prefetch" href="/assets/js/68.bd58cd56.js"><link rel="prefetch" href="/assets/js/69.aa5cdeb9.js"><link rel="prefetch" href="/assets/js/7.28177048.js"><link rel="prefetch" href="/assets/js/70.f2942ca8.js"><link rel="prefetch" href="/assets/js/71.9c89b0d4.js"><link rel="prefetch" href="/assets/js/72.2ecdd4aa.js"><link rel="prefetch" href="/assets/js/73.cad7864b.js"><link rel="prefetch" href="/assets/js/74.8301c640.js"><link rel="prefetch" href="/assets/js/75.1617b729.js"><link rel="prefetch" href="/assets/js/76.5eb00565.js"><link rel="prefetch" href="/assets/js/77.3c32a3f6.js"><link rel="prefetch" href="/assets/js/78.1a7aadd7.js"><link rel="prefetch" href="/assets/js/79.b3895da2.js"><link rel="prefetch" href="/assets/js/8.f1421748.js"><link rel="prefetch" href="/assets/js/80.5286ee30.js"><link rel="prefetch" href="/assets/js/81.9a1e4dac.js"><link rel="prefetch" href="/assets/js/82.3e56e812.js"><link rel="prefetch" href="/assets/js/83.087a88de.js"><link rel="prefetch" href="/assets/js/84.8364b634.js"><link rel="prefetch" href="/assets/js/86.3889f38b.js"><link rel="prefetch" href="/assets/js/87.84348c9b.js"><link rel="prefetch" href="/assets/js/88.165a767d.js"><link rel="prefetch" href="/assets/js/89.016e9b11.js"><link rel="prefetch" href="/assets/js/9.c78676cf.js"><link rel="prefetch" href="/assets/js/90.93531463.js"><link rel="prefetch" href="/assets/js/91.8b3715fc.js"><link rel="prefetch" href="/assets/js/92.9251174a.js"><link rel="prefetch" href="/assets/js/93.f39d6513.js"><link rel="prefetch" href="/assets/js/94.32855f95.js"><link rel="prefetch" href="/assets/js/95.cf7f5192.js"><link rel="prefetch" href="/assets/js/96.ceccefbf.js"><link rel="prefetch" href="/assets/js/97.f18f5c57.js"><link rel="prefetch" href="/assets/js/98.d6d13334.js"><link rel="prefetch" href="/assets/js/99.4bf4bf3c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.a94fce00.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-19557b78><div data-v-19557b78><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-19557b78 data-v-19557b78><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-64685f0e data-v-19557b78 data-v-19557b78><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>LazySwifts</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>LazySwifts</span>
          Â Â 
          <!---->
          2022
        </a></span></div></div> <div class="hide" data-v-19557b78><header class="navbar" data-v-19557b78><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/headhead.png" alt="LazySwifts" class="logo"> <span class="site-name">LazySwifts</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont undefined"></i>
  Home
</a></div><div class="nav-item"><a href="/Guide/" class="nav-link"><i class="iconfont undefined"></i>
  Guide
</a></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/NoCPU/" class="nav-link router-link-active"><i class="iconfont undefined"></i>
  NoCPU
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      CPU
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/CPU/Database/" class="nav-link"><i class="iconfont undefined"></i>
  Database
</a></li><li class="dropdown-item"><!----> <a href="/CPU/Management/" class="nav-link"><i class="iconfont undefined"></i>
  Management
</a></li><li class="dropdown-item"><!----> <a href="/CPU/Java/" class="nav-link"><i class="iconfont undefined"></i>
  Java
</a></li><li class="dropdown-item"><!----> <a href="/CPU/Data Science/" class="nav-link"><i class="iconfont undefined"></i>
  Data Science
</a></li><li class="dropdown-item"><!----> <a href="/CPU/Matlab/" class="nav-link"><i class="iconfont undefined"></i>
  Matlab
</a></li><li class="dropdown-item"><!----> <a href="/CPU/Operating System/" class="nav-link"><i class="iconfont undefined"></i>
  Operating System
</a></li><li class="dropdown-item"><!----> <a href="/CPU/Biochemistry and Microbiology/" class="nav-link"><i class="iconfont undefined"></i>
  Biochemistry and Microbiology
</a></li><li class="dropdown-item"><!----> <a href="/CPU/Computer Network/" class="nav-link"><i class="iconfont undefined"></i>
  Computer Network
</a></li><li class="dropdown-item"><!----> <a href="/CPU/Information Systems Analysis and Design/" class="nav-link"><i class="iconfont undefined"></i>
  Information Systems Analysis and Design
</a></li></ul></div></div><div class="nav-item"><a href="mailto:714838284@qq.com" class="nav-link external"><i class="iconfont undefined"></i>
  Contact Me
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-19557b78></div> <aside class="sidebar" data-v-19557b78><div class="personal-info-wrapper" data-v-042e23d4><img src="/headhead.png" alt="author-avatar" class="personal-img" data-v-042e23d4> <h3 class="name" data-v-042e23d4>
    LazySwifts
  </h3> <div class="num" data-v-042e23d4><div data-v-042e23d4><h3 data-v-042e23d4>80</h3> <h6 data-v-042e23d4>Article</h6></div> <div data-v-042e23d4><h3 data-v-042e23d4>26</h3> <h6 data-v-042e23d4>Tag</h6></div></div> <hr data-v-042e23d4></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link"><i class="iconfont undefined"></i>
  Home
</a></div><div class="nav-item"><a href="/Guide/" class="nav-link"><i class="iconfont undefined"></i>
  Guide
</a></div><div class="nav-item"><a href="/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/NoCPU/" class="nav-link router-link-active"><i class="iconfont undefined"></i>
  NoCPU
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      CPU
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/CPU/Database/" class="nav-link"><i class="iconfont undefined"></i>
  Database
</a></li><li class="dropdown-item"><!----> <a href="/CPU/Management/" class="nav-link"><i class="iconfont undefined"></i>
  Management
</a></li><li class="dropdown-item"><!----> <a href="/CPU/Java/" class="nav-link"><i class="iconfont undefined"></i>
  Java
</a></li><li class="dropdown-item"><!----> <a href="/CPU/Data Science/" class="nav-link"><i class="iconfont undefined"></i>
  Data Science
</a></li><li class="dropdown-item"><!----> <a href="/CPU/Matlab/" class="nav-link"><i class="iconfont undefined"></i>
  Matlab
</a></li><li class="dropdown-item"><!----> <a href="/CPU/Operating System/" class="nav-link"><i class="iconfont undefined"></i>
  Operating System
</a></li><li class="dropdown-item"><!----> <a href="/CPU/Biochemistry and Microbiology/" class="nav-link"><i class="iconfont undefined"></i>
  Biochemistry and Microbiology
</a></li><li class="dropdown-item"><!----> <a href="/CPU/Computer Network/" class="nav-link"><i class="iconfont undefined"></i>
  Computer Network
</a></li><li class="dropdown-item"><!----> <a href="/CPU/Information Systems Analysis and Design/" class="nav-link"><i class="iconfont undefined"></i>
  Information Systems Analysis and Design
</a></li></ul></div></div><div class="nav-item"><a href="mailto:714838284@qq.com" class="nav-link external"><i class="iconfont undefined"></i>
  Contact Me
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/NoCPU/" aria-current="page" class="sidebar-link">Tell You</a></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Deep Learning</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>NLP</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>C++</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Go</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/NoCPU/Go/" aria-current="page" class="sidebar-link">Tell You</a></li><li><a href="/NoCPU/Go/go-ch1.html" class="sidebar-link">ã€ŠGo è¯­è¨€åœ£ç»ã€‹å‰è¨€ã€å…¥é—¨</a></li><li><a href="/NoCPU/Go/go-ch2.html" class="sidebar-link">ã€ŠGo è¯­è¨€åœ£ç»ã€‹ç¨‹åºç»“æ„</a></li><li><a href="/NoCPU/Go/go-ch3.html" class="sidebar-link">ã€ŠGo è¯­è¨€åœ£ç»ã€‹åŸºç¡€æ•°æ®ç±»å‹</a></li><li><a href="/NoCPU/Go/go-ch4.html" class="sidebar-link">ã€ŠGo è¯­è¨€åœ£ç»ã€‹å¤åˆæ•°æ®ç±»å‹</a></li><li><a href="/NoCPU/Go/go-ch5.html" class="sidebar-link">ã€ŠGo è¯­è¨€åœ£ç»ã€‹å‡½æ•°</a></li><li><a href="/NoCPU/Go/go-ch6.html" class="sidebar-link">ã€ŠGo è¯­è¨€åœ£ç»ã€‹æ–¹æ³•</a></li><li><a href="/NoCPU/Go/go-ch7.html" class="sidebar-link">ğŸ”ºã€ŠGo è¯­è¨€åœ£ç»ã€‹æ¥å£</a></li><li><a href="/NoCPU/Go/go-ch8.html" class="sidebar-link">ğŸ”ºã€ŠGo è¯­è¨€åœ£ç»ã€‹Goroutines å’Œ Channels</a></li><li><a href="/NoCPU/Go/go-ch9.html" class="sidebar-link">ğŸ”ºã€ŠGo è¯­è¨€åœ£ç»ã€‹åŸºäºå…±äº«å˜é‡çš„å¹¶å‘</a></li><li><a href="/NoCPU/Go/go-ch10.html" class="sidebar-link">ã€ŠGo è¯­è¨€åœ£ç»ã€‹åŒ…å’Œå·¥å…·</a></li><li><a href="/NoCPU/Go/go-ch11.html" aria-current="page" class="active sidebar-link">ã€ŠGo è¯­è¨€åœ£ç»ã€‹æµ‹è¯•</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/NoCPU/Go/go-ch11.html#æµ‹è¯•" class="sidebar-link">æµ‹è¯•</a></li></ul></li><li><a href="/NoCPU/Go/go-ch12.html" class="sidebar-link">ã€ŠGo è¯­è¨€åœ£ç»ã€‹åå°„</a></li><li><a href="/NoCPU/Go/go-ch12.html" class="sidebar-link">ã€ŠGo è¯­è¨€åœ£ç»ã€‹unsafe åŒ…åº•å±‚ç¼–ç¨‹</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>LeetCode</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Software Engineering</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>ä¿ç ”</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-64685f0e data-v-19557b78><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>ã€ŠGo è¯­è¨€åœ£ç»ã€‹æµ‹è¯•</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>LazySwifts</span>
          Â Â 
          <!---->
          2022
        </a></span></div></div> <div data-v-19557b78><main class="page"><div class="page-title" style="display:none;"><h1>ã€ŠGo è¯­è¨€åœ£ç»ã€‹æµ‹è¯•</h1> <hr> <div data-v-34ea29db><i class="iconfont reco-account" data-v-34ea29db><span data-v-34ea29db>LazySwifts</span></i> <i class="iconfont reco-date" data-v-34ea29db><span data-v-34ea29db>2022-04-08 21:17:33</span></i> <i class="iconfont reco-eye" data-v-34ea29db><span id="/NoCPU/Go/go-ch11.html" data-flag-title="Your Article Title" class="leancloud-visitors" data-v-34ea29db><a class="leancloud-visitors-count" style="font-size:.9rem;font-weight:normal;color:#999;"></a></span></i> <i class="iconfont reco-tag tags" data-v-34ea29db><span class="tag-item" data-v-34ea29db>Go</span></i></div></div> <div class="theme-reco-content content__default" style="display:none;"><h2 id="æµ‹è¯•"><a href="#æµ‹è¯•" class="header-anchor">#</a> æµ‹è¯•</h2> <ul><li><p>åœ¨åŒ…ç›®å½•å†…ï¼Œä»¥ <code>_test.go</code> ä¸ºåç¼€åçš„æºæ–‡ä»¶åœ¨æ‰§è¡Œ <code>go build</code> æ—¶ä¸ä¼šè¢«æ„å»ºæˆåŒ…çš„ä¸€éƒ¨åˆ†ï¼Œå®ƒä»¬æ˜¯ go test æµ‹è¯•çš„ä¸€éƒ¨åˆ†ã€‚</p> <p>åœ¨ <code>*_test.go</code> æ–‡ä»¶ä¸­ï¼Œæœ‰ä¸‰ç§ç±»å‹çš„å‡½æ•°ï¼š</p> <ol><li><strong>æµ‹è¯•å‡½æ•°</strong>ï¼šTest ä¸ºå‡½æ•°åå‰ç¼€çš„å‡½æ•°ï¼Œç”¨äºæµ‹è¯•ç¨‹åºçš„ä¸€äº›é€»è¾‘è¡Œä¸ºæ˜¯å¦æ­£ç¡®ã€‚<code>go test</code> å‘½ä»¤ä¼šæµ‹è¯•å‡½æ•°å¹¶æŠ¥å‘Šç»“æœæ˜¯ <code>PASS</code> è¿˜æ˜¯ <code>FAIL</code></li> <li><strong>åŸºå‡†æµ‹è¯•</strong>ï¼ˆbenchmarkï¼‰å‡½æ•°ï¼šä»¥ Benchmark ä¸ºå‡½æ•°åå‰ç¼€çš„å‡½æ•°ï¼Œç”¨äºè¡¡é‡å‡½æ•°çš„æ€§èƒ½ã€‚<code>go test</code> å‘½ä»¤ä¼šå¤šæ¬¡è¿è¡ŒåŸºå‡†æµ‹è¯•å‡½æ•°ä»¥è®¡ç®—ä¸€ä¸ªå¹³å‡çš„æ‰§è¡Œæ—¶é—´ã€‚</li> <li><strong>ç¤ºä¾‹å‡½æ•°</strong>ï¼šä»¥ Example ä¸ºå‡½æ•°åå‰ç¼€çš„å‡½æ•°ï¼Œæä¾›ä¸€ä¸ªç”±ç¼–è¯‘å™¨ä¿è¯æ­£ç¡®æ€§çš„ç¤ºä¾‹æ–‡æ¡£ã€‚</li></ol> <p><code>go test</code> å‘½ä»¤ä¼šéå†æ‰€æœ‰çš„ <code>*_test.go</code> æ–‡ä»¶ä¸­ç¬¦åˆä¸Šè¿°å‘½åè§„åˆ™çš„å‡½æ•°ï¼Œç”Ÿæˆä¸€ä¸ªä¸´æ—¶çš„ main åŒ…ç”¨äºè°ƒç”¨ç›¸åº”çš„æµ‹è¯•å‡½æ•°ï¼Œæ¥ç€æ„å»ºå¹¶è¿è¡Œã€æŠ¥å‘Šæµ‹è¯•ç»“æœï¼Œæœ€åæ¸…ç†æµ‹è¯•ä¸­ç”Ÿæˆçš„ä¸´æ—¶æ–‡ä»¶ã€‚</p></li> <li><p>æµ‹è¯•å‡½æ•°</p> <ul><li><p>æ¯ä¸ªæµ‹è¯•å‡½æ•°å¿…é¡»å¯¼å…¥ <code>testing</code> åŒ…ï¼Œå‡½æ•°åå­—å¿…é¡»ä»¥ <code>Test</code> å¼€å¤´ï¼Œå¯é€‰çš„åç¼€åå¿…é¡»ä»¥å¤§å†™å­—æ¯å¼€å¤´ï¼š</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">TestName</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>å…¶ä¸­ t å‚æ•°ç”¨äºæŠ¥å‘Šæµ‹è¯•å¤±æ•ˆå’Œé™„åŠ çš„æ—¥å¿—ä¿¡æ¯ã€‚</p> <p>ä¸€ä¸ªæµ‹è¯•çš„ä¾‹å­ï¼š</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// word.go</span>
<span class="token keyword">package</span> word

<span class="token keyword">func</span> <span class="token function">IsPalindrome</span><span class="token punctuation">(</span>s <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">{</span>
	<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token keyword">range</span> s <span class="token punctuation">{</span>
		<span class="token keyword">if</span> s<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">!=</span> s<span class="token punctuation">[</span><span class="token function">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token operator">-</span>i<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
			<span class="token keyword">return</span> <span class="token boolean">false</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">return</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>

<span class="token comment">// word_test.go</span>
<span class="token keyword">package</span> word

<span class="token keyword">import</span> <span class="token string">&quot;testing&quot;</span>

<span class="token keyword">func</span> <span class="token function">TestPalindrome</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token operator">!</span><span class="token function">IsPalindrome</span><span class="token punctuation">(</span><span class="token string">&quot;detartrated&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">`Ispalindrome(&quot;detartrated&quot;) = false`</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> <span class="token operator">!</span><span class="token function">IsPalindrome</span><span class="token punctuation">(</span><span class="token string">&quot;kayak&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">`IsPalindrome(&quot;kayak&quot;) = false`</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">TestNotPalindrome</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">if</span> <span class="token function">IsPalindrome</span><span class="token punctuation">(</span><span class="token string">&quot;palindrome&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Error</span><span class="token punctuation">(</span><span class="token string">`IsPalindrome(&quot;palindrome&quot;) = true`</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><p>ç”¨å‘½ä»¤ <code>go test</code> æµ‹è¯•ï¼ˆé»˜è®¤é‡‡ç”¨å½“å‰ç›®å½•çš„åŒ…ï¼‰</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>âœ go <span class="token builtin class-name">test</span>         
PASS
ok      word    <span class="token number">3</span>.161s
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><blockquote><p>å…ˆç¼–å†™æµ‹è¯•ç”¨ä¾‹å¹¶è§‚å¯Ÿåˆ°æµ‹è¯•ç”¨ä¾‹è§¦å‘äº†å’Œç”¨æˆ·æŠ¥å‘Šçš„é”™è¯¯ç›¸åŒçš„æè¿°æ˜¯ä¸€ä¸ªå¥½çš„æµ‹è¯•ä¹ æƒ¯ã€‚åªæœ‰è¿™æ ·ï¼Œæˆ‘ä»¬æ‰èƒ½å®šä½æˆ‘ä»¬è¦çœŸæ­£è§£å†³çš„é—®é¢˜ã€‚</p> <p>å…ˆå†™æµ‹è¯•ç”¨ä¾‹çš„å¦å¤–çš„å¥½å¤„æ˜¯ï¼Œè¿è¡Œæµ‹è¯•é€šå¸¸ä¼šæ¯”æ‰‹å·¥æè¿°æŠ¥å‘Šçš„å¤„ç†æ›´å¿«ï¼Œè¿™è®©æˆ‘ä»¬å¯ä»¥è¿›è¡Œå¿«é€Ÿåœ°è¿­ä»£ã€‚å¦‚æœæµ‹è¯•é›†æœ‰å¾ˆå¤šè¿è¡Œç¼“æ…¢çš„æµ‹è¯•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åªé€‰æ‹©è¿è¡ŒæŸäº›ç‰¹å®šçš„æµ‹è¯•æ¥åŠ å¿«æµ‹è¯•é€Ÿåº¦ã€‚</p></blockquote> <ul><li>å‚æ•° <code>-v</code> å¯ä»¥ç”¨äºæ‰“å°æ¯ä¸ªæµ‹è¯•å‡½æ•°çš„åå­—å’Œè¿è¡Œæ—¶é—´</li> <li>å‚æ•° <code>-run</code> å¯¹åº”ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œåªæœ‰æµ‹è¯•å‡½æ•°åè¢«å®ƒæ­£ç¡®åŒ¹é…çš„æµ‹è¯•å‡½æ•°æ‰ä¼šè¢« <code>go test</code> æµ‹è¯•å‘½ä»¤è¿è¡Œ</li></ul></li> <li><p>å¤±è´¥æµ‹è¯•çš„è¾“å‡ºå¹¶ä¸åŒ…æ‹¬è°ƒç”¨ t.Errorf æ—¶åˆ»çš„å †æ ˆè°ƒç”¨ä¿¡æ¯ã€‚å’Œå…¶ä»–ç¼–ç¨‹è¯­è¨€æˆ–æµ‹è¯•æ¡†æ¶çš„ assert æ–­è¨€ä¸åŒï¼Œt.Errorf è°ƒç”¨ä¹Ÿæ²¡æœ‰å¼•èµ· panic å¼‚å¸¸æˆ–åœæ­¢æµ‹è¯•çš„æ‰§è¡Œã€‚å³ä½¿è¡¨æ ¼ä¸­å‰é¢çš„æ•°æ®å¯¼è‡´äº†æµ‹è¯•çš„å¤±è´¥ï¼Œè¡¨æ ¼åé¢çš„æµ‹è¯•æ•°æ®ä¾ç„¶ä¼šè¿è¡Œæµ‹è¯•ï¼Œå› æ­¤åœ¨ä¸€ä¸ªæµ‹è¯•ä¸­æˆ‘ä»¬å¯èƒ½äº†è§£å¤šä¸ªå¤±è´¥çš„ä¿¡æ¯ã€‚</p> <p>å¦‚æœæˆ‘ä»¬çœŸçš„éœ€è¦åœæ­¢æµ‹è¯•ï¼Œæˆ–è®¸æ˜¯å› ä¸ºåˆå§‹åŒ–å¤±è´¥æˆ–å¯èƒ½æ˜¯æ—©å…ˆçš„é”™è¯¯å¯¼è‡´äº†åç»­é”™è¯¯ç­‰åŸå› ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ t.Fatal æˆ– t.Fatalf åœæ­¢å½“å‰æµ‹è¯•å‡½æ•°ã€‚å®ƒä»¬å¿…é¡»åœ¨å’Œæµ‹è¯•å‡½æ•°åŒä¸€ä¸ª goroutine å†…è°ƒç”¨ã€‚</p></li> <li><p>éšæœºæµ‹è¯•</p> <p>å¯¹äºä¸€ä¸ªéšæœºçš„è¾“å…¥ï¼Œå¦‚ä½•èƒ½å¤ŸçŸ¥é“å¸Œæœ›çš„è¾“å‡ºç»“æœï¼Ÿ</p> <ul><li>ç¼–å†™å¦ä¸€ä¸ªå¯¹ç…§å‡½æ•°ï¼Œä½¿ç”¨ç®€å•å’Œæ¸…æ™°çš„ç®—æ³•ï¼Œè™½ç„¶æ•ˆç‡è¾ƒä½ä½†æ˜¯è¡Œä¸ºå’Œè¦æµ‹è¯•çš„å‡½æ•°æ˜¯ä¸€è‡´çš„ï¼Œç„¶åé’ˆå¯¹ç›¸åŒçš„éšæœºè¾“å…¥æ£€æŸ¥ä¸¤è€…çš„è¾“å‡ºç»“æœã€‚</li> <li>ç”Ÿæˆçš„éšæœºè¾“å…¥çš„æ•°æ®éµå¾ªç‰¹å®šçš„æ¨¡å¼ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥çŸ¥é“æœŸæœ›çš„è¾“å‡ºçš„æ¨¡å¼ã€‚</li></ul></li> <li><p>æµ‹è¯•ä¸€ä¸ªå‘½ä»¤ï¼ˆå¯æ‰§è¡Œç¨‹åºï¼‰ï¼šmain åŒ…åœ¨æ„å»ºæ—¶ä¼šç”Ÿæˆä¸€ä¸ªå¯æ‰§è¡Œç¨‹åºï¼Œmain åŒ…å¯ä»¥ä½œä¸ºä¸€ä¸ªåŒ…è¢«æµ‹è¯•å™¨ä»£ç å¯¼å…¥ã€‚main åŒ…åœ¨æµ‹è¯•æ—¶ï¼Œmain å…¥å£å‡½æ•°ä¼šè¢«å¿½ç•¥ï¼Œå…¶åªæ˜¯ä½œä¸ºæµ‹è¯•å‡½æ•°å¯¼å…¥çš„ä¸€ä¸ªæ™®é€šåŒ…ï¼Œé‡Œé¢çš„ main å‡½æ•°å¹¶æ²¡æœ‰è¢«å¯¼å‡ºã€‚</p> <p>åœ¨æµ‹è¯•ä»£ç ä¸­è°ƒç”¨ <code>log.Fatal</code> æˆ– <code>os.Exit</code> ä¼šä½¿ç¨‹åºæå‰é€€å‡ºï¼Œè°ƒç”¨è¿™äº›å‡½æ•°çš„ç‰¹æƒåº”è¯¥æ”¾åœ¨ main å‡½æ•°ä¸­ã€‚å¹¶ä¸”å‘ç”Ÿ panic å¼‚å¸¸æ—¶ï¼Œæµ‹è¯•é©±åŠ¨åº”è¯¥å°è¯•ç”¨ recover æ•è·å¼‚å¸¸ï¼Œå°†å½“å‰æµ‹è¯•å½“ä½œå¤±è´¥å¤„ç†ï¼Œå…¶ä»–æƒ…å†µåº”è¯¥è¿”å›ä¸€ä¸ªéç©ºçš„ errorã€‚</p></li> <li><p>ç™½ç›’æµ‹è¯•ï¼šæœ‰è®¿é—®åŒ…å†…éƒ¨å‡½æ•°å’Œæ•°æ®ç»“æ„çš„æƒé™ã€‚</p> <blockquote><p>é»‘ç›’æµ‹è¯•åªéœ€è¦æµ‹è¯•åŒ…å…¬å¼€çš„æ–‡æ¡£å’ŒAPIè¡Œä¸ºï¼Œå†…éƒ¨å®ç°å¯¹æµ‹è¯•ä»£ç æ˜¯é€æ˜çš„ã€‚é»‘ç›’å’Œç™½ç›’è¿™ä¸¤ç§æµ‹è¯•æ–¹æ³•æ˜¯äº’è¡¥çš„ã€‚é»‘ç›’æµ‹è¯•ä¸€èˆ¬æ›´å¥å£®ï¼Œéšç€è½¯ä»¶å®ç°çš„å®Œå–„æµ‹è¯•ä»£ç å¾ˆå°‘éœ€è¦æ›´æ–°ã€‚å®ƒä»¬å¯ä»¥å¸®åŠ©æµ‹è¯•è€…äº†è§£çœŸå®å®¢æˆ·çš„éœ€æ±‚ï¼Œä¹Ÿå¯ä»¥å¸®åŠ©å‘ç°APIè®¾è®¡çš„ä¸€äº›ä¸è¶³ä¹‹å¤„ã€‚ç›¸åï¼Œç™½ç›’æµ‹è¯•åˆ™å¯ä»¥å¯¹å†…éƒ¨ä¸€äº›æ£˜æ‰‹çš„å®ç°æä¾›æ›´å¤šçš„æµ‹è¯•è¦†ç›–ã€‚</p></blockquote> <p>åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥ç”¨å¦ä¸€ä¸ªå®ç°ï¼ˆä¼ªå¯¹è±¡ï¼‰ä»£æ›¿æ ‡å‡†è¾“å‡ºï¼ˆä»¥é¿å…ä¸€äº›ä¸è‰¯çš„å‰¯ä½œç”¨ï¼‰ï¼Œä½¿å¾—ç»“æœæ›´å®¹æ˜“è§‚å¯Ÿã€‚ä½¿ç”¨ä¼ªå¯¹è±¡çš„å¥½å¤„æ˜¯æˆ‘ä»¬å¯ä»¥æ–¹ä¾¿é…ç½®ï¼Œå®¹æ˜“é¢„æµ‹ï¼Œæ›´å¯é ï¼Œä¹Ÿæ›´å®¹æ˜“è§‚å¯Ÿã€‚</p> <p>ä¾‹å­ï¼šä¸ºç”¨æˆ·æä¾›ç½‘ç»œå­˜å‚¨çš„ web æœåŠ¡ä¸­çš„é…é¢æ£€æµ‹é€»è¾‘ã€‚å½“ç”¨æˆ·ä½¿ç”¨äº†è¶…è¿‡ 90% çš„å­˜å‚¨é…é¢ä¹‹åå°†å‘é€æé†’é‚®ä»¶ã€‚</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">bytesInUse</span><span class="token punctuation">(</span>username <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token builtin">int64</span> <span class="token punctuation">{</span>
	<span class="token keyword">return</span> <span class="token number">0</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> sender <span class="token operator">=</span> <span class="token string">&quot;notifications@example.com&quot;</span>
<span class="token keyword">const</span> password <span class="token operator">=</span> <span class="token string">&quot;correcthorsebatterystaple&quot;</span>
<span class="token keyword">const</span> hostname <span class="token operator">=</span> <span class="token string">&quot;smtp.example.com&quot;</span>

<span class="token keyword">const</span> template <span class="token operator">=</span> <span class="token string">`Warning: you are using %d bytes of storage,
%d%% of your quota.`</span>

<span class="token keyword">func</span> <span class="token function">CheckQuota</span><span class="token punctuation">(</span>username <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	used <span class="token operator">:=</span> <span class="token function">bytesInUse</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span>
	<span class="token keyword">const</span> quota <span class="token operator">=</span> <span class="token number">1000000000</span>
	percent <span class="token operator">:=</span> <span class="token number">100</span> <span class="token operator">*</span> used <span class="token operator">/</span> quota
	<span class="token keyword">if</span> percent <span class="token operator">&lt;</span> <span class="token number">90</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	msg <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span>template<span class="token punctuation">,</span> used<span class="token punctuation">,</span> percent<span class="token punctuation">)</span>
	auth <span class="token operator">:=</span> smtp<span class="token punctuation">.</span><span class="token function">PlainAuth</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> sender<span class="token punctuation">,</span> password<span class="token punctuation">,</span> hostname<span class="token punctuation">)</span>
	err <span class="token operator">:=</span> smtp<span class="token punctuation">.</span><span class="token function">SendMail</span><span class="token punctuation">(</span>hostname<span class="token operator">+</span><span class="token string">&quot;:587&quot;</span><span class="token punctuation">,</span> auth<span class="token punctuation">,</span> sender<span class="token punctuation">,</span>
		<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>username<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		log<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;smtp.SendMail(%s) failed: %s&quot;</span><span class="token punctuation">,</span> username<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>æˆ‘ä»¬æƒ³æµ‹è¯•è¿™æ®µä»£ç ï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶ä¸å¸Œæœ›å‘é€çœŸå®çš„é‚®ä»¶ã€‚å› æ­¤æˆ‘ä»¬å°†é‚®ä»¶å¤„ç†é€»è¾‘æ”¾åˆ°ä¸€ä¸ªç§æœ‰çš„ notifyUser å‡½æ•°ä¸­ï¼š</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">var</span> notifyUser <span class="token operator">=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> msg <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	auth <span class="token operator">:=</span> smtp<span class="token punctuation">.</span><span class="token function">PlainAuth</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">,</span> sender<span class="token punctuation">,</span> password<span class="token punctuation">,</span> hostname<span class="token punctuation">)</span>
	err <span class="token operator">:=</span> smtp<span class="token punctuation">.</span><span class="token function">SendMail</span><span class="token punctuation">(</span>hostname<span class="token operator">+</span><span class="token string">&quot;:587&quot;</span><span class="token punctuation">,</span> auth<span class="token punctuation">,</span> sender<span class="token punctuation">,</span>
		<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span><span class="token punctuation">{</span>username<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token function">byte</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span>
	<span class="token keyword">if</span> err <span class="token operator">!=</span> <span class="token boolean">nil</span> <span class="token punctuation">{</span>
		log<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;smtp.SendMail(%s) failed: %s&quot;</span><span class="token punctuation">,</span> username<span class="token punctuation">,</span> err<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">CheckQuota</span><span class="token punctuation">(</span>username <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	used <span class="token operator">:=</span> <span class="token function">bytesInUse</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span>
	<span class="token keyword">const</span> quota <span class="token operator">=</span> <span class="token number">1000000000</span>
	percent <span class="token operator">:=</span> <span class="token number">100</span> <span class="token operator">*</span> used <span class="token operator">/</span> quota
	<span class="token keyword">if</span> percent <span class="token operator">&lt;</span> <span class="token number">90</span> <span class="token punctuation">{</span>
		<span class="token keyword">return</span>
	<span class="token punctuation">}</span>
	msg <span class="token operator">:=</span> fmt<span class="token punctuation">.</span><span class="token function">Sprintf</span><span class="token punctuation">(</span>template<span class="token punctuation">,</span> used<span class="token punctuation">,</span> percent<span class="token punctuation">)</span>
	<span class="token function">notifyUser</span><span class="token punctuation">(</span>username<span class="token punctuation">,</span> msg<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>åœ¨æµ‹è¯•çš„æ—¶å€™é€šè¿‡ä¼ªé‚®ä»¶å‘é€å‡½æ•°æ›¿ä»£çœŸå®çš„é‚®ä»¶å‘é€å‡½æ•°ï¼š</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">TestCheckQuotaNotifiesUser</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token keyword">var</span> notifiedUser<span class="token punctuation">,</span> notifiedMsg <span class="token builtin">string</span>
	notifyUser <span class="token operator">=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> msg <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		notifiedUser<span class="token punctuation">,</span> notifiedMsg <span class="token operator">=</span> user<span class="token punctuation">,</span> msg
	<span class="token punctuation">}</span>

	<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token string">&quot;joe@example.org&quot;</span>
	<span class="token function">CheckQuota</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>

	<span class="token keyword">if</span> notifiedUser <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token operator">&amp;&amp;</span> notifiedMsg <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Fatalf</span><span class="token punctuation">(</span><span class="token string">&quot;notifyUser not called&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> notifiedMsg <span class="token operator">!=</span> user <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;wrong user (%s) notified, want %s&quot;</span><span class="token punctuation">,</span>
			notifiedUser<span class="token punctuation">,</span> user<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">const</span> wantSubstring <span class="token operator">=</span> <span class="token string">&quot;98% of your quota&quot;</span>
	<span class="token keyword">if</span> <span class="token operator">!</span>strings<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>notifiedMsg<span class="token punctuation">,</span> wantSubstring<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;unexpected notification message &lt;&lt;%s&gt;&gt;, &quot;</span><span class="token operator">+</span>
			<span class="token string">&quot;want substring %q&quot;</span><span class="token punctuation">,</span> notifiedMsg<span class="token punctuation">,</span> wantSubstring<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>è¿™é‡Œæœ‰ä¸€ä¸ªé—®é¢˜ï¼šå½“æµ‹è¯•å‡½æ•°è¿”å›åï¼ŒCheckQuota å°†ä¸èƒ½æ­£å¸¸å·¥ä½œï¼Œå› ä¸º notifyUsers ä¾ç„¶ä½¿ç”¨çš„æ˜¯æµ‹è¯•å‡½æ•°çš„ä¼ªå‘é€é‚®ä»¶å‡½æ•°ï¼ˆå½“æ›´æ–°å…¨å±€å¯¹è±¡çš„æ—¶å€™æ€»ä¼šæœ‰è¿™ç§é£é™©ï¼‰ã€‚ æˆ‘ä»¬å¿…é¡»ä¿®æ”¹æµ‹è¯•ä»£ç æ¢å¤ notifyUsers åŸå…ˆçš„çŠ¶æ€ä»¥ä¾¿åç»­å…¶ä»–çš„æµ‹è¯•æ²¡æœ‰å½±å“ï¼Œè¦ç¡®ä¿æ‰€æœ‰çš„æ‰§è¡Œè·¯å¾„åéƒ½èƒ½æ¢å¤ï¼ŒåŒ…æ‹¬æµ‹è¯•å¤±è´¥æˆ– panic å¼‚å¸¸çš„æƒ…å½¢ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å»ºè®®ä½¿ç”¨ defer è¯­å¥æ¥å»¶åæ‰§è¡Œå¤„ç†æ¢å¤çš„ä»£ç ã€‚</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">TestCheckQuotaNotifiesUser</span><span class="token punctuation">(</span>t <span class="token operator">*</span>testing<span class="token punctuation">.</span>T<span class="token punctuation">)</span> <span class="token punctuation">{</span>
	saved <span class="token operator">:=</span> notifyUser
	<span class="token keyword">defer</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		notifyUser <span class="token operator">=</span> saved
	<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
	
	<span class="token keyword">var</span> notifiedUser<span class="token punctuation">,</span> notifiedMsg <span class="token builtin">string</span>
	notifyUser <span class="token operator">=</span> <span class="token keyword">func</span><span class="token punctuation">(</span>user<span class="token punctuation">,</span> msg <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		notifiedUser<span class="token punctuation">,</span> notifiedMsg <span class="token operator">=</span> user<span class="token punctuation">,</span> msg
	<span class="token punctuation">}</span>

	<span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token string">&quot;joe@example.org&quot;</span>
	<span class="token function">CheckQuota</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span>

	<span class="token keyword">if</span> notifiedUser <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token operator">&amp;&amp;</span> notifiedMsg <span class="token operator">==</span> <span class="token string">&quot;&quot;</span> <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Fatalf</span><span class="token punctuation">(</span><span class="token string">&quot;notifyUser not called&quot;</span><span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
	<span class="token keyword">if</span> notifiedMsg <span class="token operator">!=</span> user <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;wrong user (%s) notified, want %s&quot;</span><span class="token punctuation">,</span>
			notifiedUser<span class="token punctuation">,</span> user<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">const</span> wantSubstring <span class="token operator">=</span> <span class="token string">&quot;98% of your quota&quot;</span>
	<span class="token keyword">if</span> <span class="token operator">!</span>strings<span class="token punctuation">.</span><span class="token function">Contains</span><span class="token punctuation">(</span>notifiedMsg<span class="token punctuation">,</span> wantSubstring<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		t<span class="token punctuation">.</span><span class="token function">Errorf</span><span class="token punctuation">(</span><span class="token string">&quot;unexpected notification message &lt;&lt;%s&gt;&gt;, &quot;</span><span class="token operator">+</span>
			<span class="token string">&quot;want substring %q&quot;</span><span class="token punctuation">,</span> notifiedMsg<span class="token punctuation">,</span> wantSubstring<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p>è¿™ç§å¤„ç†æ¨¡å¼å¯ä»¥ç”¨æ¥æš‚æ—¶ä¿å­˜å’Œæ¢å¤æ‰€æœ‰çš„å…¨å±€å˜é‡ï¼ŒåŒ…æ‹¬å‘½ä»¤è¡Œæ ‡å¿—å‚æ•°ã€è°ƒè¯•é€‰é¡¹å’Œä¼˜åŒ–å‚æ•°ï¼›å®‰è£…å’Œç§»é™¤å¯¼è‡´ç”Ÿäº§ä»£ç äº§ç”Ÿä¸€äº›è°ƒè¯•ä¿¡æ¯çš„é’©å­å‡½æ•°ï¼›è¿˜æœ‰æœ‰äº›è¯±å¯¼ç”Ÿäº§ä»£ç è¿›å…¥æŸäº›é‡è¦çŠ¶æ€çš„æ”¹å˜ï¼Œæ¯”å¦‚è¶…æ—¶ã€é”™è¯¯ï¼Œç”šè‡³æ˜¯ä¸€äº›åˆ»æ„åˆ¶é€ çš„å¹¶å‘è¡Œä¸ºç­‰å› ç´ ã€‚</p> <p>ä»¥è¿™ç§æ–¹å¼ä½¿ç”¨å…¨å±€å˜é‡æ˜¯å®‰å…¨çš„ï¼Œå› ä¸º go test å‘½ä»¤å¹¶ä¸ä¼šåŒæ—¶å¹¶å‘åœ°æ‰§è¡Œå¤šä¸ªæµ‹è¯•ã€‚</p></li> <li><p>å¤–éƒ¨æµ‹è¯•åŒ…ï¼š</p> <p>net/http åŒ…ä¾èµ– net/url åŒ…ï¼Œå¦‚æœåœ¨ net/url åŒ…ä¸­è¿›è¡Œæµ‹è¯•ï¼Œå¯¼å…¥ net/http åŒ…ï¼Œä¼šäº§ç”Ÿå¾ªç¯ä¾èµ–ï¼Œå¯¼è‡´ç¼–è¯‘é”™è¯¯ï¼›å¯ä»¥é‡‡ç”¨å¤–éƒ¨æµ‹è¯•åŒ…çš„æ–¹å¼æ¥è§£å†³è¯¥é—®é¢˜ï¼Œå°±æ˜¯è¯´é€šè¿‡å¦ä¸€ä¸ªåŒ…ä¾èµ– net/http å’Œ net/url åŒ…æ¥å®Œæˆæµ‹è¯•</p> <img src="http://books.studygolang.com/gopl-zh/images/ch11-01.png" alt="img" style="zoom:50%;"> <img src="http://books.studygolang.com/gopl-zh/images/ch11-02.png" alt="img" style="zoom:33%;"> <p>å¯ä»¥é€šè¿‡ <code>go list</code> å‘½ä»¤æŸ¥çœ‹åŒ…å¯¹åº”ç›®å½•ä¸­å“ªäº› Go æºæ–‡ä»¶æ˜¯äº§å“ä»£ç ï¼Œå“ªäº›æ˜¯åŒ…å†…æµ‹è¯•ï¼š</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ go list -f<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>.GoFiles<span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token function">fmt</span> <span class="token comment"># äº§å“ä»£ç </span>
<span class="token punctuation">[</span>doc.go format.go print.go scan.go<span class="token punctuation">]</span>

$ go list -f<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>.TestGoFiles<span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token function">fmt</span> <span class="token comment"># åŒ…å†…éƒ¨æµ‹è¯•ä»£ç </span>
<span class="token punctuation">[</span>export_test.go<span class="token punctuation">]</span>

$ go list -f<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>.XTestGoFiles<span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token function">fmt</span> <span class="token comment"># å¤–éƒ¨æµ‹è¯•åŒ…çš„æµ‹è¯•ä»£ç ï¼ˆfmt_test åŒ…ï¼‰</span>
<span class="token punctuation">[</span>fmt_test.go scan_test.go stringer_test.go<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>æœ‰æ—¶å€™å¤–éƒ¨æµ‹è¯•åŒ…ä¹Ÿéœ€è¦è®¿é—®è¢«æµ‹è¯•åŒ…å†…éƒ¨çš„ä»£ç ï¼Œä¾‹å¦‚åœ¨ä¸€ä¸ªä¸ºäº†é¿å…å¾ªç¯å¯¼å…¥è€Œè¢«ç‹¬ç«‹åˆ°å¤–éƒ¨æµ‹è¯•åŒ…çš„ç™½ç›’æµ‹è¯•ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€äº›æŠ€å·§è§£å†³ï¼šæˆ‘ä»¬åœ¨åŒ…å†…çš„ä¸€ä¸ª <code>_test.go</code> æ–‡ä»¶ä¸­å¯¼å‡ºä¸€ä¸ªå†…éƒ¨çš„å®ç°ç»™å¤–éƒ¨æµ‹è¯•åŒ…ã€‚å› ä¸ºè¿™äº›ä»£ç åªæœ‰åœ¨æµ‹è¯•æ—¶æ‰éœ€è¦ï¼Œå› æ­¤ä¸€èˆ¬ä¼šæ”¾åœ¨ <code>export_test.go</code> æ–‡ä»¶ä¸­ã€‚</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token comment">// export_test.go</span>
<span class="token keyword">package</span> fmt
<span class="token keyword">var</span> IsSpace <span class="token operator">=</span> isSpace <span class="token comment">// å¯¼å‡ºå†…éƒ¨å‡½æ•°</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div></li> <li><p>ä¸€ä¸ªå¥½çš„æµ‹è¯•ä¸åº”è¯¥å¼•å‘å…¶ä»–æ— å…³çš„é”™è¯¯ä¿¡æ¯ï¼Œå®ƒåªè¦æ¸…æ™°ç®€æ´åœ°æè¿°é—®é¢˜çš„ç—‡çŠ¶å³å¯ï¼Œæœ‰æ—¶å€™å¯èƒ½è¿˜éœ€è¦ä¸€äº›ä¸Šä¸‹æ–‡ä¿¡æ¯ã€‚åœ¨ç†æƒ³æƒ…å†µä¸‹ï¼Œç»´æŠ¤è€…å¯ä»¥åœ¨ä¸çœ‹ä»£ç çš„æƒ…å†µä¸‹å°±èƒ½æ ¹æ®é”™è¯¯ä¿¡æ¯å®šä½é”™è¯¯äº§ç”Ÿçš„åŸå› ã€‚ä¸€ä¸ªå¥½çš„æµ‹è¯•ä¸åº”è¯¥åœ¨é‡åˆ°ä¸€ç‚¹å°é”™è¯¯æ—¶å°±ç«‹åˆ»é€€å‡ºæµ‹è¯•ï¼Œå®ƒåº”è¯¥å°è¯•æŠ¥å‘Šæ›´å¤šçš„ç›¸å…³çš„é”™è¯¯ä¿¡æ¯ï¼Œå› ä¸ºæˆ‘ä»¬å¯èƒ½ä»å¤šä¸ªå¤±è´¥æµ‹è¯•çš„æ¨¡å¼ä¸­å‘ç°é”™è¯¯äº§ç”Ÿçš„è§„å¾‹ã€‚</p></li> <li><p>é¿å…è„†å¼±çš„æµ‹è¯•ï¼šå¦‚æœä¸€ä¸ªåº”ç”¨ç¨‹åºå¯¹äºæ–°å‡ºç°çš„ä½†æœ‰æ•ˆçš„è¾“å…¥ç»å¸¸å¤±è´¥è¯´æ˜ç¨‹åºå®¹æ˜“å‡ºbugï¼ˆä¸å¤Ÿç¨³å¥ï¼‰ï¼›åŒæ ·ï¼Œå¦‚æœä¸€ä¸ªæµ‹è¯•ä»…ä»…å¯¹ç¨‹åºåšäº†å¾®å°å˜åŒ–å°±å¤±è´¥ï¼ˆä¸èƒ½å†ä½¿ç”¨ï¼‰åˆ™ç§°ä¸ºè„†å¼±ã€‚æ¯”å¦‚å‡½æ•°ä¿®æ”¹åï¼ŒåŸæ¥æµ‹è¯•çš„è¾“å…¥è¾“å‡ºä¹Ÿè¦ä¿®æ”¹ã€‚</p> <blockquote><p>é¿å…è„†å¼±æµ‹è¯•ä»£ç çš„æ–¹æ³•æ˜¯åªæ£€æµ‹ä½ çœŸæ­£å…³å¿ƒçš„å±æ€§ã€‚ä¿æŒæµ‹è¯•ä»£ç çš„ç®€æ´å’Œå†…éƒ¨ç»“æ„çš„ç¨³å®šã€‚ç‰¹åˆ«æ˜¯å¯¹æ–­è¨€éƒ¨åˆ†è¦æœ‰æ‰€é€‰æ‹©ã€‚ä¸è¦å¯¹å­—ç¬¦ä¸²è¿›è¡Œå…¨å­—åŒ¹é…ï¼Œè€Œæ˜¯é’ˆå¯¹é‚£äº›åœ¨é¡¹ç›®çš„å‘å±•ä¸­æ˜¯æ¯”è¾ƒç¨³å®šä¸å˜çš„å­ä¸²ã€‚å¾ˆå¤šæ—¶å€™å€¼å¾—èŠ±åŠ›æ°”æ¥ç¼–å†™ä¸€ä¸ªä»å¤æ‚è¾“å‡ºä¸­æå–ç”¨äºæ–­è¨€çš„å¿…è¦ä¿¡æ¯çš„å‡½æ•°ï¼Œè™½ç„¶è¿™å¯èƒ½ä¼šå¸¦æ¥å¾ˆå¤šå‰æœŸçš„å·¥ä½œï¼Œä½†æ˜¯å®ƒå¯ä»¥å¸®åŠ©è¿…é€ŸåŠæ—¶ä¿®å¤å› ä¸ºé¡¹ç›®æ¼”åŒ–è€Œå¯¼è‡´çš„ä¸åˆé€»è¾‘çš„å¤±è´¥æµ‹è¯•ã€‚</p></blockquote></li></ul></li> <li><p>æµ‹è¯•è¦†ç›–ç‡ï¼šè¯­å¥çš„è¦†ç›–ç‡æ˜¯æŒ‡åœ¨æµ‹è¯•ä¸­è‡³å°‘è¢«è¿è¡Œä¸€æ¬¡çš„ä»£ç å æ€»ä»£ç æ•°çš„æ¯”ä¾‹</p> <p>å¯ä»¥ç”¨ <code>go tool cover</code> æŸ¥çœ‹ç”¨æ³•ï¼Œ<code>go tool</code> å‘½ä»¤è¿è¡Œ Go å·¥å…·é“¾çš„åº•å±‚å¯æ‰§è¡Œç¨‹åº</p> <ul><li><code>go test -coverprofile=c.out</code>ï¼š<code>-coverprofile</code> æ ‡å¿—å‚æ•°é€šè¿‡åœ¨æµ‹è¯•ä»£ç ä¸­æ’å…¥ç”Ÿæˆé’©å­æ¥ç»Ÿè®¡è¦†ç›–ç‡æ•°æ®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨è¿è¡Œæ¯ä¸ªæµ‹è¯•å‰ï¼Œå®ƒå°†å¾…æµ‹ä»£ç æ‹·è´ä¸€ä»½å¹¶åšä¿®æ”¹ï¼Œåœ¨æ¯ä¸ªè¯æ³•å—éƒ½ä¼šè®¾ç½®ä¸€ä¸ªå¸ƒå°”æ ‡å¿—å˜é‡ã€‚å½“è¢«ä¿®æ”¹åçš„è¢«æµ‹è¯•ä»£ç è¿è¡Œé€€å‡ºæ—¶ï¼Œå°†ç»Ÿè®¡æ—¥å¿—æ•°æ®å†™å…¥c.outæ–‡ä»¶ï¼Œå¹¶æ‰“å°ä¸€éƒ¨åˆ†æ‰§è¡Œçš„è¯­å¥çš„ä¸€ä¸ªæ€»ç»“ã€‚ï¼ˆå¦‚æœåªéœ€è¦æ‘˜è¦ï¼Œåˆ™ä½¿ç”¨ <code>go test -cover</code>ï¼‰</li> <li><code>go test -covermode=count</code>ï¼šåœ¨æ¯ä¸ªä»£ç å—æ’å…¥ä¸€ä¸ªè®¡æ•°å™¨è€Œä¸æ˜¯å¸ƒå°”æ ‡å¿—é‡ã€‚åœ¨ç»Ÿè®¡ç»“æœä¸­è®°å½•äº†æ¯ä¸ªå—çš„æ‰§è¡Œæ¬¡æ•°ï¼Œè¿™å¯ä»¥ç”¨äºè¡¡é‡å“ªäº›æ˜¯è¢«é¢‘ç¹æ‰§è¡Œçš„çƒ­ç‚¹ä»£ç ã€‚</li> <li><code>go tool cover -html=c.out</code> ç”Ÿæˆ HTML æŠ¥å‘Š</li></ul></li> <li><p>åŸºå‡†æµ‹è¯•ï¼šåŸºå‡†æµ‹è¯•æ˜¯æµ‹é‡ä¸€ä¸ªç¨‹åºåœ¨å›ºå®šå·¥ä½œè´Ÿè½½ä¸‹çš„æ€§èƒ½ã€‚ä»¥ Benchmark ä¸ºå‰ç¼€åï¼Œå¹¶ä¸”å¸¦æœ‰ä¸€ä¸ª <code>*testing.B</code> ç±»å‹çš„å‚æ•°ï¼›<code>*testing.B</code> å‚æ•°é™¤äº†æä¾›å’Œ <code>*testing.T</code> ç±»ä¼¼çš„æ–¹æ³•ï¼Œè¿˜æœ‰é¢å¤–ä¸€äº›å’Œæ€§èƒ½æµ‹é‡ç›¸å…³çš„æ–¹æ³•ã€‚å®ƒè¿˜æä¾›äº†ä¸€ä¸ªæ•´æ•° Nï¼Œç”¨äºæŒ‡å®šæ“ä½œæ‰§è¡Œçš„å¾ªç¯æ¬¡æ•°ã€‚</p> <blockquote><p>å› ä¸ºåŸºå‡†æµ‹è¯•é©±åŠ¨å™¨å¼€å§‹æ—¶å¹¶ä¸çŸ¥é“æ¯ä¸ªåŸºå‡†æµ‹è¯•å‡½æ•°è¿è¡Œæ‰€èŠ±çš„æ—¶é—´ï¼Œå®ƒä¼šå°è¯•åœ¨çœŸæ­£è¿è¡ŒåŸºå‡†æµ‹è¯•å‰å…ˆå°è¯•ç”¨è¾ƒå°çš„ N è¿è¡Œæµ‹è¯•æ¥ä¼°ç®—åŸºå‡†æµ‹è¯•å‡½æ•°æ‰€éœ€è¦çš„æ—¶é—´ï¼Œç„¶åæ¨æ–­ä¸€ä¸ªè¾ƒå¤§çš„æ—¶é—´ä¿è¯ç¨³å®šçš„æµ‹é‡ç»“æœã€‚</p></blockquote> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">BenchmarkIsPalindrome</span><span class="token punctuation">(</span>b <span class="token operator">*</span>testing<span class="token punctuation">.</span>B<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> b<span class="token punctuation">.</span>N<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
    <span class="token function">IsPalindrome</span><span class="token punctuation">(</span><span class="token string">&quot;A man, a plan, a canal: Panama&quot;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>å¾ªç¯åœ¨åŸºå‡†æµ‹è¯•å†…éƒ¨å®ç°ï¼Œè€Œä¸æ˜¯æ”¾åœ¨åŸºå‡†æµ‹è¯•æ¡†æ¶å†…å®ç°ï¼Œè¿™æ ·å¯ä»¥è®©æ¯ä¸ªåŸºå‡†æµ‹è¯•å‡½æ•°æœ‰æœºä¼šåœ¨å¾ªç¯å¯åŠ¨å‰æ‰§è¡Œåˆå§‹åŒ–ä»£ç ã€‚å¦‚æœè¿˜æ˜¯æ‹…å¿ƒåˆå§‹åŒ–ä»£ç éƒ¨åˆ†å¯¹æµ‹é‡æ—¶é—´å¸¦æ¥å¹²æ‰°ï¼Œå¯ä»¥é€šè¿‡ testing.B å‚æ•°æä¾›çš„æ–¹æ³•æ¥ä¸´æ—¶å…³é—­æˆ–é‡ç½®è®¡æ—¶å™¨ï¼Œä½†å¾ˆå°‘è¿™ä¹ˆåšã€‚</p> <p>é»˜è®¤æƒ…å†µä¸‹ä¸è¿è¡Œä»»ä½•åŸºå‡†æµ‹è¯•ï¼Œéœ€è¦é€šè¿‡ <code>-bench</code> å‘½ä»¤è¡Œæ ‡å¿—å‚æ•°æ‰‹å·¥æŒ‡å®šè¦è¿è¡Œçš„åŸºå‡†æµ‹è¯•å‡½æ•°ï¼ˆæ­£åˆ™è¡¨è¾¾å¼ï¼‰<code>go test -bench=.</code></p> <p>åŸºå‡†æµ‹è¯•å¯ä»¥è¯„ä¼°ä¸¤ç§ä¸åŒç®—æ³•å¯¹äºç›¸åŒçš„è¾“å…¥åœ¨ä¸åŒçš„åœºæ™¯å’Œè´Ÿè½½ä¸‹çš„ä¼˜ç¼ºç‚¹ã€‚</p> <ul><li><p>æ¯”è¾ƒå‹çš„åŸºå‡†æµ‹è¯•ï¼šé€šå¸¸æ˜¯å•å‚æ•°çš„å‡½æ•°ï¼Œç”±ä¸åŒæ•°é‡çº§çš„åŸºå‡†æµ‹è¯•å‡½æ•°è°ƒç”¨ï¼š</p> <div class="language-go line-numbers-mode"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">benchmark</span><span class="token punctuation">(</span>b <span class="token operator">*</span>testing<span class="token punctuation">.</span>B<span class="token punctuation">,</span> size <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">/* ... */</span> <span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">Benchmark10</span><span class="token punctuation">(</span>b <span class="token operator">*</span>testing<span class="token punctuation">.</span>B<span class="token punctuation">)</span>         <span class="token punctuation">{</span> <span class="token function">benchmark</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">Benchmark100</span><span class="token punctuation">(</span>b <span class="token operator">*</span>testing<span class="token punctuation">.</span>B<span class="token punctuation">)</span>        <span class="token punctuation">{</span> <span class="token function">benchmark</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
<span class="token keyword">func</span> <span class="token function">Benchmark1000</span><span class="token punctuation">(</span>b <span class="token operator">*</span>testing<span class="token punctuation">.</span>B<span class="token punctuation">)</span>       <span class="token punctuation">{</span> <span class="token function">benchmark</span><span class="token punctuation">(</span>b<span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>é€šè¿‡å‡½æ•°å‚æ•°æ¥æŒ‡å®šè¾“å…¥çš„å¤§å°ï¼Œä½†æ˜¯å‚æ•°å˜é‡å¯¹äºæ¯ä¸ªå…·ä½“çš„åŸºå‡†æµ‹è¯•éƒ½æ˜¯å›ºå®šçš„ã€‚è¦é¿å…ç›´æ¥ä¿®æ”¹ b.N æ¥æ§åˆ¶è¾“å…¥çš„å¤§å°ã€‚</p></li></ul></li> <li><p>å‰–æï¼šå‰–ææŠ€æœ¯æ˜¯åŸºäºç¨‹åºæ‰§è¡ŒæœŸé—´ä¸€äº›è‡ªåŠ¨æŠ½æ ·ï¼Œç„¶ååœ¨æ”¶å°¾æ—¶è¿›è¡Œæ¨æ–­ï¼›æœ€åäº§ç”Ÿçš„ç»Ÿè®¡ç»“æœå°±ç§°ä¸ºå‰–ææ•°æ®ã€‚</p> <ul><li><p>CPU å‰–ææ•°æ®æ ‡è¯†äº†æœ€è€— CPU æ—¶é—´çš„å‡½æ•°ã€‚åœ¨æ¯ä¸ª CPU ä¸Šè¿è¡Œçš„çº¿ç¨‹åœ¨æ¯éš”å‡ æ¯«ç§’éƒ½ä¼šé‡åˆ°æ“ä½œç³»ç»Ÿçš„ä¸­æ–­äº‹ä»¶ï¼Œæ¯æ¬¡ä¸­æ–­æ—¶éƒ½ä¼šè®°å½•ä¸€ä¸ªå‰–ææ•°æ®ç„¶åæ¢å¤æ­£å¸¸çš„è¿è¡Œã€‚</p> <p><code>go test -cpuprofile=cpu.out</code></p></li> <li><p>å †å‰–æåˆ™æ ‡è¯†äº†æœ€è€—å†…å­˜çš„è¯­å¥ã€‚å‰–æåº“ä¼šè®°å½•è°ƒç”¨å†…éƒ¨å†…å­˜åˆ†é…çš„æ“ä½œï¼Œå¹³å‡æ¯ 512KB çš„å†…å­˜ç”³è¯·ä¼šè§¦å‘ä¸€ä¸ªå‰–ææ•°æ®ã€‚</p> <p><code>go test -memprofile=mem.out</code></p></li> <li><p>é˜»å¡å‰–æåˆ™è®°å½•é˜»å¡ goroutine æœ€ä¹…çš„æ“ä½œï¼Œä¾‹å¦‚ç³»ç»Ÿè°ƒç”¨ã€ç®¡é“å‘é€å’Œæ¥æ”¶ï¼Œè¿˜æœ‰è·å–é”ç­‰ã€‚æ¯å½“ goroutine è¢«è¿™äº›æ“ä½œé˜»å¡æ—¶ï¼Œå‰–æåº“éƒ½ä¼šè®°å½•ç›¸åº”çš„äº‹ä»¶ã€‚</p> <p><code>go test -blockprofile=block.out</code></p></li></ul> <p>å½“åŒæ—¶ä½¿ç”¨å¤šä¸ªæ ‡å¿—å‚æ•°æ—¶éœ€è¦å½“å¿ƒï¼Œå› ä¸ºä¸€é¡¹åˆ†ææ“ä½œå¯èƒ½ä¼šå½±å“å…¶ä»–é¡¹çš„åˆ†æç»“æœã€‚</p> <ul><li>å‰–æå¯¹äºé•¿æœŸè¿è¡Œçš„ç¨‹åºå°¤å…¶æœ‰ç”¨ï¼Œå› æ­¤å¯ä»¥é€šè¿‡è°ƒç”¨ Go çš„ runtime API æ¥å¯ç”¨è¿è¡Œæ—¶å‰–æã€‚</li> <li>å¯ä»¥ç”¨ pprof æ¥åˆ†ææ”¶é›†åˆ°çš„é‡‡æ ·æ•°æ®ï¼Œå¯¹åº” <code>go tool pprof</code> å‘½ä»¤ï¼Œå…¶æœ‰æœ€åŸºæœ¬çš„ä¸¤ä¸ªå‚æ•°ï¼šç”Ÿæˆè¿™ä¸ªæ¦‚è¦æ–‡ä»¶çš„å¯æ‰§è¡Œç¨‹åºå’Œå¯¹åº”çš„å‰–ææ•°æ®ã€‚å› ä¸ºåˆ†ææ—¥å¿—æœ¬èº«ä¸åŒ…å«å‡½æ•°ï¼ŒåªåŒ…å«å‡½æ•°çš„åœ°å€ï¼Œæ‰€ä»¥ pprof éœ€è¦å¯¹åº”çš„å¯æ‰§è¡Œç¨‹åºã€‚è™½ç„¶ <code>go test</code> é€šå¸¸åœ¨æµ‹è¯•å®Œæˆåå°±ä¸¢å¼ƒä¸´æ—¶ç”¨çš„æµ‹è¯•ç¨‹åºï¼Œä½†æ˜¯åœ¨å¯ç”¨åˆ†æçš„æ—¶å€™ä¼šå°†æµ‹è¯•ç¨‹åºä¿å­˜ä¸º foo.test æ–‡ä»¶ï¼Œå…¶ä¸­ foo éƒ¨åˆ†å¯¹åº”å¾…æµ‹åŒ…çš„åå­—ã€‚</li></ul></li> <li><p>ç¤ºä¾‹å‡½æ•°ï¼šç¤ºä¾‹å‡½æ•°æ²¡æœ‰å‡½æ•°å‚æ•°å’Œè¿”å›å€¼ã€‚</p> <p>ç¤ºä¾‹å‡½æ•°çš„ç”¨å¤„ï¼š</p> <ol><li>ä½œä¸ºæ–‡æ¡£ï¼Œæ¼”ç¤ºå‡½æ•°çš„ç”¨æ³•ï¼›godoc ä¼šå°†ç¤ºä¾‹å‡½æ•°å…³è”åˆ°æŸä¸ªå…·ä½“å‡½æ•°æˆ–åŒ…æœ¬èº«ï¼ˆé€šè¿‡ç¤ºä¾‹å‡½æ•°çš„åç¼€åéƒ¨åˆ†ï¼‰ï¼Œå› æ­¤<code>ExampleIsPalindrome</code> ç¤ºä¾‹å‡½æ•°å°†æ˜¯ <code>IsPalindrome</code> å‡½æ•°æ–‡æ¡£çš„ä¸€éƒ¨åˆ†ï¼ŒExample ç¤ºä¾‹å‡½æ•°å°†æ˜¯åŒ…æ–‡æ¡£çš„ä¸€éƒ¨åˆ†ã€‚</li> <li><code>go test</code> ä¹Ÿä¼šæ‰§è¡Œç¤ºä¾‹å‡½æ•°ï¼Œé€šè¿‡ <code>// Output:</code> æ³¨é‡Šï¼Œæµ‹è¯•å·¥å…·ä¼šæ£€æŸ¥ç¤ºä¾‹å‡½æ•°çš„æ ‡å‡†è¾“å‡ºä¸æ³¨é‡Šæ˜¯å¦åŒ¹é…</li></ol></li></ul></div> <footer class="page-edit" style="display:none;"><!----> <!----></footer> <!----> <!----></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-44bd5a18 data-v-44bd5a18><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-44bd5a18><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-44bd5a18></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-44bd5a18></path></svg></div></div></div>
    <script src="/assets/js/app.80d57d75.js" defer></script><script src="/assets/js/3.187167f1.js" defer></script><script src="/assets/js/1.965fe851.js" defer></script><script src="/assets/js/85.b19281d5.js" defer></script>
  </body>
</html>
